<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notificações - RealMe</title>
  <link rel="icon" href="./src/icon/icon.png" type="image/png" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#1F1F1F" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="./src/icon/icon.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="./src/styles/base.css" />
  <link rel="stylesheet" href="./src/styles/layout.css" />
  <link rel="stylesheet" href="./src/styles/components.css" />
  <link rel="stylesheet" href="./src/styles/media-queries.css" />
  <link rel="stylesheet" href="./src/styles/navbars.css" />
  <link rel="stylesheet" href="./src/styles/notifications.css" />
  <link rel="stylesheet" href="./src/styles/search.css" />
  <link rel="stylesheet" href="./src/styles/nt-modal.css">
</head>
<body>
 <div class="glass-overlay"></div>

  <!-- Navbar -->
  <nav>
    <div class="logo_area">
      <div class="logo">RealMe</div>
    </div>
    <div class="search-area">
      <div class="search-box">
        <button><i class="fas fa-search"></i></button>
        <input type="text" id="searchInput" placeholder="Buscar" autocomplete="off"  />
      </div>
    </div>

    <div class="last-update-area">
      <div class="last-update">
        <p>Novidades!</p>
      </div>
    </div>
    <div class="marquee-container">
      <div class="marquee">Conectando...</div>
    </div>
  </nav>

  <!-- Sidebar -->
  <aside class="sidebar">
    <a href="feed.html"><i class="fas fa-home"></i> Início</a>
    <a href="acharamigos.html"><i class="fas fa-user-friends"></i> Achar Amigos</a>
    <a href="direct.html"><i class="fas fa-comments"></i> Mensagens</a>
    <a href="nt.html" style="position: relative;">
      <i class="fas fa-bell"></i> Notificações
      <span class="notification-badge" style="display: none;">0</span>
    </a>
    <a href="feed.html"><i class="fas fa-plus-square"></i> Criar</a>
    <a href="#" id="linkPerfilSidebar"><i class="fas fa-user"></i> Perfil</a>
    <!-- Menu Mais -->
    <div class="more-menu" id="moreMenu">
      <a href="#" class="more-toggle" id="moreToggle">
        <i class="fa-solid fa-bars"></i> Mais
      </a>
      <div class="floating-menu" id="floatingMenu">
        <a href="config.html"><i class="fas fa-cog"></i> Configurações</a>
        <a href="invites.html"><i class="fa-solid fa-user-plus"></i> Convites</a>
        <a href="como-usar.html"><i class="fa-solid fa-book-open"></i> Como Usar</a>
        <a href="sobre.html"><i class="fas fa-question-circle"></i> Sobre</a>
        <a href="#" id="btnSair"><i class="fas fa-sign-out-alt"></i> Sair</a>
      </div>
    </div>
  </aside>

    <!-- Navbar Bottom -->
  <nav class="navbar-bottom">
    <div class="navbar-bottom-content">
      <a href="feed.html">
        <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 511 511.832">
  <path fill-rule="nonzero" d="M29.337 511.832c-8.09 0-15.428-3.3-20.732-8.605C3.3 497.923 0 490.585 0 482.495V244.611c.059-5.681 2.298-11.346 6.733-15.568L241.038 5.915c8.236-7.846 21.284-7.927 29.616 0l232.514 221.323c4.782 3.957 7.832 9.931 7.832 16.614v238.643c0 7.964-3.316 15.391-8.642 20.717-5.253 5.253-12.591 8.62-20.695 8.62H327.059c-11.891 0-21.542-9.651-21.542-21.542V364.721c0-14.109-5.739-26.913-14.978-36.145l-.081-.081c-9.231-9.238-22.036-14.978-36.144-14.978-14.087 0-26.913 5.762-36.189 15.015-9.253 9.276-15.014 22.102-15.014 36.189V490.29c0 11.891-9.652 21.542-21.543 21.542H29.337z"/>
</svg>
      </a>
      <a href="acharamigos.html">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
<g>
	<path d="M384,448v-42.7c0-58.9-47.7-106.7-106.7-106.7H106.7C47.7,298.7,0,346.4,0,405.3V448c0,11.8,9.6,21.3,21.3,21.3
		c11.8,0,21.3-9.6,21.3-21.3v-42.7c0.1-35.3,28.7-63.9,64-64l170.7,0c35.3,0.1,63.9,28.7,64,64V448c0,11.8,9.6,21.3,21.3,21.3
		S384,459.8,384,448z"/>
	<path d="M192,64v21.3c35.3,0.1,63.9,28.7,64,64c-0.1,35.3-28.7,63.9-64,64c-35.3-0.1-63.9-28.7-64-64c0.1-35.3,28.7-63.9,64-64V64
		V42.7c-58.9,0-106.7,47.7-106.7,106.7C85.3,208.3,133.1,256,192,256c58.9,0,106.7-47.7,106.7-106.7c0-58.9-47.7-106.7-106.7-106.7
		V64z"/>
	<path d="M512,448v-42.7c0-48.6-32.9-91.1-80-103.2c-11.4-2.9-23,3.9-26,15.3c-2.9,11.4,3.9,23,15.3,26c28.2,7.3,48,32.8,48,61.9
		V448c0,11.8,9.6,21.3,21.3,21.3S512,459.8,512,448z"/>
	<path d="M336,87.4c28.9,7.4,48.1,33.5,48.1,61.9c0,5.2-0.6,10.6-2,15.9c-5.8,22.6-23.5,40.3-46.1,46.1c-11.4,2.9-18.3,14.5-15.4,26
		c2.9,11.4,14.5,18.3,26,15.4c37.7-9.7,67.2-39.1,76.9-76.9c2.3-8.8,3.4-17.7,3.4-26.5c0-47.6-32-90.9-80.2-103.3
		c-11.4-2.9-23,4-26,15.4C317.7,72.9,324.6,84.5,336,87.4L336,87.4z"/>
</g>
</svg>
      </a>
      <a href="direct-mobile.html">
        <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 506 511.682"><path fill-rule="nonzero" d="M76.022 432.762c-14.224-17.624-28.477-36.009-40.468-55.504-13.738-22.329-24.838-46.442-30.326-73.172-14.057-68.387.935-136.064 36.561-190.148C77.414 59.833 133.687 19.322 202.118 5.235c68.394-14.071 136.056.928 190.14 36.547 54.105 35.632 94.638 91.912 108.71 160.35 7.003 34.067 6.445 67.452-.116 99.01-7.018 33.734-20.937 65.408-39.78 93.639-25.671 38.445-58.723 65.581-98.51 82.009-39.837 16.45-86.054 21.88-138.014 16.979l-9.714-.928c-19.966-1.928-27.528-2.653-33.487-1.094-4.343 1.181-9.932 3.69-18.842 7.677l-8.381 3.734c-20.756 9.229-36.009 10.44-47.878 6.14-15.499-5.618-22.503-17.566-25.765-33.023-1.624-7.706-2.139-15.739-2.675-24.221-.399-6.445-.841-13.231-1.784-19.292zm47.972-127.857l61.768-98.785c10.976-16.573 33.719-20.177 49.357-7.924l52.024 40.917c4.785 3.734 11.469 3.886 16.363.319l66.038-46.413c9.678-7.032 21.873 4.698 15.297 14.681l-62.355 97.785c-10.977 16.566-33.719 20.176-49.357 7.917l-52.024-40.918c-4.785-3.734-11.462-3.893-16.363-.319l-65.509 47.37c-9.671 7.032-21.872-4.64-15.239-14.63zM74.761 353.16c11.976 19.473 26.273 37.597 40.323 54.902a22.782 22.782 0 014.785 9.693c2.501 10.962 3.175 21.532 3.799 31.428.384 6.104.754 11.919 1.493 16.232 2.226-.775 5.633-2.16 10.462-4.299l8.177-3.596c11.23-5.031 18.284-8.192 25.679-10.164h.094c13.688-3.646 23.49-2.711 49.581-.188l9.716.928c44.484 4.197 83.43-.196 116.25-13.746 31.246-12.905 57.36-34.444 77.833-65.103 15.616-23.395 27.144-49.596 32.936-77.457 5.336-25.686 5.8-52.822.116-80.48-11.52-56.026-44.673-102.084-88.919-131.221-44.274-29.158-99.72-41.432-155.79-29.891-56.012 11.528-102.07 44.674-131.199 88.912-29.166 44.282-41.433 99.728-29.906 155.798 4.205 20.495 13.246 39.852 24.57 58.252z"/></svg>
      </a>
      <a href="explorar.html">
        <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 510.784"><path fill-rule="nonzero" d="M217.587 0c60.082 0 114.478 24.36 153.849 63.73 39.371 39.371 63.731 93.782 63.731 153.857 0 52.338-18.484 100.353-49.276 137.893l119.914 119.387c8.228 8.183 8.264 21.495.081 29.722s-21.495 8.264-29.722.081l-119.93-119.395c-37.641 31.166-85.957 49.892-138.647 49.892-60.075 0-114.486-24.36-153.857-63.731C24.36 332.065 0 277.669 0 217.587 0 157.512 24.36 103.101 63.73 63.73 103.101 24.36 157.512 0 217.587 0zm124.046 93.533c-31.737-31.737-75.605-51.379-124.046-51.379-48.448 0-92.317 19.642-124.054 51.379-31.737 31.737-51.379 75.606-51.379 124.054 0 48.441 19.642 92.309 51.379 124.046 31.737 31.737 75.606 51.379 124.054 51.379 48.441 0 92.309-19.642 124.046-51.379 31.737-31.737 51.379-75.605 51.379-124.046 0-48.448-19.642-92.317-51.379-124.054z"/></svg>
      </a>
      <a href="pfmobile.html">
        <img src="./src/icon/default.jpg" alt="Perfil" class="profile-mini" id="nav-pic">
      </a>
    </div>
  </nav>

  <ul id="searchResults"></ul>

  <!-- Container de Notificações -->
  <div class="notifications-container">
    <div class="notifications-header">
      <p class="desktop-title">Notificações de <span id="userDisplayName">Usuário</span>!</p>
        <button onclick="window.history.back()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 298 511.93">
            <path d="M285.77 441c16.24 16.17 16.32 42.46.15 58.7-16.16 16.24-42.45 16.32-58.69.16l-215-214.47c-16.24-16.16-16.32-42.45-.15-58.69L227.23 12.08c16.24-16.17 42.53-16.09 58.69.15 16.17 16.24 16.09 42.54-.15 58.7l-185.5 185.04L285.77 441z"/>
          </svg>
        </button>
      <p class="mobile-title">Notificações</p>
    </div>
    <div class="notifications"></div>
  </div>

  <!-- Modal de Post -->
  <div class="post-modal" id="postModal">
    <div class="post-modal-content">
      <button class="close-post-modal" onclick="closePostOverlay()">
        <i class="fas fa-times"></i>
      </button>
      <h2>Fazer Nova <span>Postagem</span>!</h2>

      <textarea id="postText" placeholder="Compartilhe algo..."></textarea>

      <label class="file-input-label">
        <i class="fas fa-image"></i> Adicionar imagem
        <input type="file" id="postImageInput" accept="image/*" />
      </label>

      <div id="imagePreview" class="image-preview"></div>
      <button id="removeImageBtn" class="remove-image-btn" style="display:none;" onclick="removeImage()">
        Remover Imagem
      </button>

      <button class="submit-post-btn" onclick="submitPost()">Postar!</button>
    </div>
  </div>

  <ul id="searchResults"></ul>

  <!-- Scripts -->
  <script src="./src/js/more.js"></script>
  <script src="./src/js/nt-modal.js"></script>
  
  <!-- Sistema de Notificações -->
   
  <script type="module">
    import { 
      inicializarPaginaNotificacoes, 
      inicializarBadgeNotificacoes 
    } from './src/js/nt-notifications.js';
    
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const auth = getAuth();
    const db = getFirestore();

    // Inicializa o sistema de notificações
    document.addEventListener('DOMContentLoaded', () => {
      inicializarPaginaNotificacoes();
      inicializarBadgeNotificacoes();
    });

    // Atualiza o nome do usuário no header
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        const userRef = doc(db, "users", user.uid);
        const userSnap = await getDoc(userRef);
        let displayname = user.email;
        if (userSnap.exists()) {
          const data = userSnap.data();
          displayname = data.displayname || displayname;
        }
        const span = document.getElementById('userDisplayName');
        if (span) span.textContent = displayname;
      }
    });
  </script>
</body>
</html>